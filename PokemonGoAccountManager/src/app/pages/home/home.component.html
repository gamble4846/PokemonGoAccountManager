<div class="home-page">
  <header class="header">
    <h1>Pokémon GO Accounts</h1>
  </header>

  @if (showPasswordForm()) {
    <div class="password-card">
      <p class="password-intro">Enter your password to unlock accounts. It will be saved on this device so you don’t have to enter it again.</p>
      <form (ngSubmit)="onSubmitPassword()" class="password-form">
        <input
          type="password"
          [(ngModel)]="passwordInput"
          name="password"
          class="password-input"
          placeholder="Password"
          autocomplete="current-password"
        />
        <button type="submit" class="btn btn-primary">Unlock</button>
      </form>
    </div>
  } @else if (loading()) {
    <div class="loading">Loading...</div>
  } @else if (error()) {
    <div class="error-banner">{{ error() }}</div>
  } @else if (groups().length === 0) {
    <div class="empty-state">
      <p>No accounts loaded.</p>
      <p>Use the upload page to add a CSV and encrypt it with a password, then enter that password here.</p>
    </div>
  } @else {
    <div class="categories">
      @for (group of groups(); track group.name) {
        <section class="category">
          <h2 class="category-title">{{ group.name }}</h2>
          <div class="cards-grid">
            @for (row of getCardRows(group.items); track $index) {
              <div class="card-row">
                @for (account of row; track account.email + account.userName) {
                  <app-account-card
                    [account]="account"
                    [copiedField]="copiedKey()"
                    (copy)="onCopy($event)"
                  />
                }
              </div>
              @if (!$last) {
                <div class="row-separator" aria-hidden="true"></div>
              }
            }
          </div>
        </section>
      }
    </div>
  }
</div>
